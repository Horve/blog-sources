title: 使用Chrome DevTools的Timeline分析页面性能
date: 2015-10-26 14:59:25
tags:
- timeline
- 前端性能
categories:
- 原创
- tools
---

随着webpage可以承载的表现形式更加多样化，通过webpage来实现更多交互功能，构建web应用程序已经成为很多产品的首要选择。这种方式拥有非常明显的优势：跨平台、开发便捷、便于部署和维护等等，但随着功能的不断积累，web应用程序也会变得越来越复杂。但是，我们仍然想要在webpage支持丰富的呈现形式的同时，让页面效果能够达到>=60fps(帧)/s的刷新频率以避免出现卡顿，就需要我们使用一些比较直观的方式来分析衡量页面的性能问题，为性能优化方案提供依据。

> 为什么是60fps?
> > 我们的目标是保证页面要有高于每秒60fps(帧)的刷新频率，这和目前大多数显示器的刷新率相吻合(60Hz)，这样，应用的每一帧的渲染耗时应该低于16.6ms（1000ms/60）。

需求大体明确，就是要找到页面执行过程中的性能瓶颈。而Chrome DevTools的Timeline则正是用来记录和分析应用在运行时所有的活动情况，它是用来排查应用性能瓶颈的最佳工具。

下图是Timeline面板的预览效果：

![Timeline预览效果图](/images/timeline/timeline-preview.png)

> Tips:为了避免浏览器插件对分析过程产生影响，建议在隐身模式下进行分析。

## Timeline工具栏介绍

Timeline工具会详细检测出在Web应用加载的过程中时间花费情况的概览，包括下载资源、处理DOM事件、页面布局渲染、向屏幕绘制元素等。你可以通过分析Timeline得到的事件、框架和实时的内存用量，找出应用的性能问题。

![Timeline的两种模式](/images/timeline/timeline-1.png)

在分析页面前，需要首先开启录制功能，记录页面的操作和渲染记录。如上图，左上角的灰色圆点就是录制按钮，点击后会变成红色，然后在页面上进行相关操作后再次按下变成灰色完成录制，这样就完成了一次对操作及加载渲染的记录过程，随后Timeline就会开始分析操作过程中的各项性能参数。

Timeline同时提供了两种查看模式：“事件模式(Event Mode)”和“帧模式(Frame Mode)”。如上图箭头所示。

> 事件模式：显示重新渲染的各种事件花费的时间。
> 帧模式：显示每一帧的时间花费情况。

## 事件模式 (Event Mode)

## 帧模式 (Frame Mode)